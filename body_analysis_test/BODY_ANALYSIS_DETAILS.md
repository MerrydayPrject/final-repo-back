# 체형 분석 상세 설명

## 📊 MediaPipe Pose Landmarker - 33개 랜드마크

MediaPipe Pose Landmarker는 **33개의 신체 랜드마크 포인트**를 제공합니다:

### 얼굴/머리 (5개)
- 0: 코 (Nose)
- 2: 왼쪽 눈 (Left Eye Inner)
- 5: 오른쪽 눈 (Right Eye Inner)
- 7: 왼쪽 귀 (Left Ear)
- 8: 오른쪽 귀 (Right Ear)

### 상체 (12개)
- 11: 왼쪽 어깨 (Left Shoulder) ✅ **사용 중**
- 12: 오른쪽 어깨 (Right Shoulder) ✅ **사용 중**
- 13: 왼쪽 팔꿈치 (Left Elbow) ✅ **사용 중**
- 14: 오른쪽 팔꿈치 (Right Elbow) ✅ **사용 중**
- 15: 왼쪽 손목 (Left Wrist) ✅ **사용 중**
- 16: 오른쪽 손목 (Right Wrist) ✅ **사용 중**
- 17: 왼쪽 새끼손가락 (Left Pinky)
- 18: 오른쪽 새끼손가락 (Right Pinky)
- 19: 왼쪽 검지 (Left Index)
- 20: 오른쪽 검지 (Right Index)
- 21: 왼쪽 엄지 (Left Thumb)
- 22: 오른쪽 엄지 (Right Thumb)

### 하체 (16개)
- 23: 왼쪽 엉덩이 (Left Hip) ✅ **사용 중**
- 24: 오른쪽 엉덩이 (Right Hip) ✅ **사용 중**
- 25: 왼쪽 무릎 (Left Knee) ✅ **사용 중**
- 26: 오른쪽 무릎 (Right Knee) ✅ **사용 중**
- 27: 왼쪽 발목 (Left Ankle) ✅ **사용 중**
- 28: 오른쪽 발목 (Right Ankle) ✅ **사용 중**
- 29: 왼쪽 발뒤꿈치 (Left Heel)
- 30: 오른쪽 발뒤꿈치 (Right Heel)
- 31: 왼쪽 발가락 (Left Foot Index) ✅ **사용 중**
- 32: 오른쪽 발가락 (Right Foot Index) ✅ **사용 중**

---

## 🔍 현재 분석 범위

### ✅ 현재 사용 중인 랜드마크 (10개)
1. **코 (0)** - 키 추정용
2. **어깨 (11, 12)** - 어깨 폭 계산
3. **팔꿈치 (13, 14)** - 팔 길이 계산
4. **손목 (15, 16)** - 팔 길이 계산
5. **엉덩이 (23, 24)** - 엉덩이 폭 계산
6. **무릎 (25, 26)** - 다리 길이 계산
7. **발목 (27, 28)** - 다리 길이 계산
8. **발가락 (31, 32)** - 키 추정용

### ❌ 현재 사용하지 않는 랜드마크 (23개)
- 얼굴: 눈, 귀
- 손: 새끼손가락, 검지, 엄지
- 발: 발뒤꿈치

---

## 📐 현재 계산하는 측정값

### 1. 어깨 폭
- 랜드마크: 11 (왼쪽 어깨), 12 (오른쪽 어깨)
- 계산: 두 점 사이 거리

### 2. 엉덩이 폭
- 랜드마크: 23 (왼쪽 엉덩이), 24 (오른쪽 엉덩이)
- 계산: 두 점 사이 거리

### 3. 허리 폭 (추정)
- 계산: (어깨 폭 + 엉덩이 폭) / 2
- ⚠️ **실제 허리 랜드마크는 없음** - 중간점으로 추정

### 4. 팔 길이
- 랜드마크: 어깨 → 팔꿈치 → 손목
- 계산: 어깨-팔꿈치 거리 + 팔꿈치-손목 거리

### 5. 다리 길이
- 랜드마크: 엉덩이 → 무릎 → 발목
- 계산: 엉덩이-무릎 거리 + 무릎-발목 거리

### 6. 키 추정
- 랜드마크: 코 → 발가락 중심
- 계산: 두 점 사이 거리

### 7. 어깨/엉덩이 비율
- 계산: 어깨 폭 / 엉덩이 폭
- **체형 분류의 핵심 지표**

---

## 🎯 체형 분류 방식

### ❌ 프롬프트로 조정되지 않음
체형 분류는 **하드코딩된 Python 로직**으로 이루어집니다:

```python
# body_analysis.py의 classify_body_type() 함수
if shoulder_hip_ratio < 0.9:
    body_type = "A라인"
elif shoulder_hip_ratio > 1.1:
    body_type = "X라인"
elif 0.95 <= shoulder_hip_ratio <= 1.05:
    body_type = "H라인"
else:
    body_type = "O라인"
```

### ✅ 프롬프트로 조정되는 부분
**Gemini API 프롬프트**는 다음에만 사용됩니다:
- 체형의 특징과 장점 설명
- 드레스 스타일 추천
- 상세 분석 텍스트 생성

---

## 🔧 확장 가능한 분석 범위

### 추가로 분석 가능한 부위

#### 1. 허리 (Waist)
- **문제**: MediaPipe에는 허리 랜드마크가 없음
- **해결책**: 
  - 어깨와 엉덩이의 중간점 사용 (현재 방식)
  - 또는 어깨-엉덩이 사이의 특정 비율 지점 사용

#### 2. 목 (Neck)
- 랜드마크: 없음
- 어깨와 코의 중간점으로 추정 가능

#### 3. 가슴 (Chest)
- 랜드마크: 없음
- 어깨와 허리(추정)의 중간점 사용

#### 4. 상체/하체 비율
- 이미 계산 가능: 팔 길이, 다리 길이 사용
- 상체 길이 = 어깨 → 엉덩이
- 하체 길이 = 엉덩이 → 발목

#### 5. 팔/다리 비율
- 이미 계산 중: `arm_length`, `leg_length`
- 현재는 사용하지 않지만 계산은 됨

---

## 💡 개선 가능한 부분

### 1. 허리 비율 추가
```python
# 허리/어깨 비율
waist_shoulder_ratio = waist_width / shoulder_width

# 허리/엉덩이 비율  
waist_hip_ratio = waist_width / hip_width
```

### 2. 상체/하체 비율
```python
# 상체 길이 (어깨 → 엉덩이)
torso_length = distance(shoulder_center, hip_center)

# 하체 길이 (엉덩이 → 발목)
lower_body_length = leg_length

# 상체/하체 비율
torso_leg_ratio = torso_length / lower_body_length
```

### 3. 팔/다리 비율
```python
# 팔/다리 비율
arm_leg_ratio = arm_length / leg_length
```

### 4. 더 정교한 체형 분류
- 허리 비율을 추가하면 8자형, 사과형 등 구분 가능
- 상체/하체 비율로 V라인, Y라인 구분 가능

---

## 📝 요약

### 현재 상황
- ✅ **분석 가능**: 얼굴, 어깨, 팔, 엉덩이, 다리, 발
- ❌ **분석 불가**: 허리 (랜드마크 없음, 추정만 가능)
- ✅ **계산 중**: 어깨 폭, 엉덩이 폭, 팔 길이, 다리 길이, 키
- ❌ **미사용**: 팔/다리 비율, 상체/하체 비율

### 체형 분류
- ❌ **프롬프트 아님**: Python 코드로 하드코딩
- ✅ **프롬프트 사용**: Gemini API는 상세 분석과 드레스 추천만

### 확장 가능성
- ✅ **가능**: 허리 비율, 상체/하체 비율 추가
- ✅ **가능**: 더 많은 체형 타입 추가 (V라인, Y라인, 8자형 등)


